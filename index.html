<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>COSMIC: Clique-Oriented Semantic Multi-space Integration for Robust CLIP Test-Time Adaptation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>
  <div class="navbar-menu">
    <div class="navbar-start" style="flex-grow: 1; justify-content: center;">
      <a class="navbar-item" href="https://hf618.github.io">
      <span class="icon">
          <i class="fas fa-home"></i>
      </span>
      </a>

        </div>
      </div>
    </div>

  </div>
</nav>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">COSMIC: Clique-Oriented Semantic Multi-space Integration for Robust CLIP Test-Time Adaptation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://hf618.github.io">Fanding Huang</a><sup>1,*</sup>,</span>
            <span class="author-block">
              <a href="https://www.jiangjingyan.com">Jingyan Jiang</a><sup>2,*</sup>,</span>
            <span class="author-block">
              <a href="https://dblp.org/pid/285/0493.html">Qinting Jiang</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://scholar.google.cz/citations?user=rgeEZmsAAAAJ&hl=zh-CN">Hebei Li</a><sup>3</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.sigs.tsinghua.edu.cn/Faisal/main.htm">Faisal Nadeem Khan</a><sup>1,&dagger;</sup>,
            </span>
            <span class="author-block">
              <a href="http://zwang.inflexionlab.org/">Zhi Wang</a><sup>1,&dagger;</sup>,
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Tsinghua Shenzhen International Graduate School, Tsinghua University</span>
          </div>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>2</sup>Shenzhen Technology University</span>
            &nbsp;
            &nbsp;
            <span class="author-block"><sup>3</sup>University of Science and Technology of China</span>
            <br>
            <p style="padding: 10px"></p>
            <span style="font-weight: bold;">CVPR 2025</span>
          </div>
          
          

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://arxiv.org/pdf/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/hf618/COSMIC"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>

            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>




<section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body" style="display: flex; justify-content: space-between; align-items: center;">
      <div style="flex: 1; text-align: center; padding-right: 40px;">
        <img src="static/images/Cache_method.png" alt="Previous Cache-based Methods" style="width: 100%; max-width: 1200px;">
        <h3 class="subtitle">(a) Previous Cache-based Methods</h3>
      </div>

      <div style="border-left: 2px solid #000; height: 250px;"></div>

      <div style="flex: 1; text-align: center; padding-left: 40px;">
        <img src="static/images/COSMIC_method.png" alt="COSMIC" style="width: 100%; max-width: 1200px;">
        <h3 class="subtitle">(b) COSMIC (Ours)</h3>
      </div>
    </div>
    
    <div class="method-overview-text has-text-justified" style="font-size: 17.6px;">
      <p>
        (a) In the previous cache-based method, the cache has only dull information with coarse-grained clip visual features and simple query way via similarity between samples and cached visual class centers. 
          (b) In our COSMIC, the cache has diverse structural information via extra fine-grained DINOv2 visual features and effective query way via similarity between samples and meticulously designed hyper-class centers.
      </p>
  </div>
  </div>
  <p style="padding: 15px"></p>
</section>

<section class="hero is-light is-small">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <p style="padding: 15px"></p>
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
          Recent vision-language models (VLMs) face significant challenges in test-time adaptation to novel domains. 
            While cache-based methods show promise by leveraging historical information, 
            they struggle with both caching unreliable feature-label pairs and indiscriminately using single-class information during querying, significantly compromising adaptation accuracy.
          </p>
        <p>
          To address these limitations, we propose <strong>COSMIC</strong> (<u>C</u>lique-<u>O</u>riented <u>S</u>emantic <u>M</u>ulti-space <u>I</u>ntegration for <u>C</u>LIP), 
          a robust test-time adaptation framework that enhances adaptability through multi-granular, cross-modal semantic caching and graph-based querying mechanisms. 
          Our framework introduces two key innovations: <em>Dual Semantics Graph</em> (DSG) and <em>Clique Guided Hyper-class</em> (CGH). 
          The Dual Semantics Graph constructs complementary semantic spaces by incorporating textual features, coarse-grained CLIP features, and fine-grained DINOv2 features to capture rich semantic relationships. 
          Building upon these dual graphs, the Clique Guided Hyper-class component leverages structured class relationships to enhance prediction robustness through correlated class selection. Extensive experiments demonstrate COSMIC's superior performance across multiple benchmarks, 
          achieving significant improvements over state-of-the-art methods: 15.81% gain on out-of-distribution tasks and 5.33% on cross-domain generation with CLIP RN-50.
        </p>
        </div>
      </div>
    </div>
    <p style="padding: 15px"></p>
</section>


<section class="section">
  <p style="padding: 15px"></p>
  <div class="container is-max-desktop">
    <div style="text-align: center; margin-bottom: 20px;">
      <h2 class="title">Overview</h2>
      <p style="padding: 15px"></p>
        <img src="static/images/cosmic_overview.png" alt="COSMIC Overview" style="width: 105%; max-width: 2000px; transform: scale(1.1); transform-origin: center;">
      <p style="padding: 5px"></p>
      <h3 class="subtitle">Overview of COSMIC</h3>
      <p style="padding: 10px"></p>
      <div class="method-overview-text" style="text-align: justify; margin: auto; max-width: 100%; font-size: 17.6px;">
        <p>
          <strong>Overview of COSMIC.</strong> To refine cache with cross-modal, multi-granular class features, 
          we construct <em>Dual Semantics Graph</em> with complementary semantics, incorporating both joint modalities and fine-grained visual information. 
          To efficiently query the compatibility of diverse semantics, we propose novel <em>Clique Guided Hyper-class</em> to model different communities in the cache as the test domain evolves, 
          enabling adaptive querying of test samples.
        </p>
        <br>
      </div>
    </div>
    
  </div>
  
<section class="section">
  <div class="container is-max-desktop">
    <div class="method-overview-text" style="text-align: justify; margin: auto; max-width: 100%; font-size: 17.6px;">
      <h2 class="title" style="text-align: center;">COSMIC Evaluation</h2>
      <p style="padding: 10px"></p>
      <p>We evaluated COSMIC alongside state-of-the-art methods on on out-of-distribution and cross-domain benchmarks, using CLIP with a ViT-B/16 backbone. The tables below present our comprehensive results.</p>
      <p style="padding: 20px"></p>

      <!-- First Table - ImageNet Variants -->
      <div class="table-container" style="text-align: center; overflow-x: auto; margin-bottom: 30px;">
        <table class="subtitle" style="width: 100%; margin-left: auto; margin-right: auto; min-width: 900px; border-collapse: collapse;">
          <caption class="subtitle" style="caption-side: bottom; text-align: center; padding-top: 20px; margin-bottom: 10px;">
            <b>Top-1 accuracy (%) comparison on ImageNet and its OOD variants</b>
          </caption>
          <tbody>
            <tr><td colspan="8" style="border-bottom: 2px solid #ddd;"></td></tr>
            <tr>
              <th style="padding: 12px 15px; text-align: left; min-width: 220px; white-space: nowrap;">Method</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 115px;">ImageNet</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">ImageNet-A</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">ImageNet-V2</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">ImageNet-R</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">ImageNet-S</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 110px;">Average</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 110px;">OOD Average</th>
            </tr>
            <tr><td colspan="8" style="border-bottom: 2px solid #ddd;"></td></tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2103.00020">CLIP-ViT-B/16</a></td>
              <td style="padding: 12px 15px; text-align: center;">66.73</td>
              <td style="padding: 12px 15px; text-align: center;">47.87</td>
              <td style="padding: 12px 15px; text-align: center;">60.86</td>
              <td style="padding: 12px 15px; text-align: center;">73.98</td>
              <td style="padding: 12px 15px; text-align: center;">46.09</td>
              <td style="padding: 12px 15px; text-align: center;">59.11</td>
              <td style="padding: 12px 15px; text-align: center;">57.20</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2209.07511">TPT</a> (NeurIPS'22)</td>
              <td style="padding: 12px 15px; text-align: center;">68.98</td>
              <td style="padding: 12px 15px; text-align: center;">54.77</td>
              <td style="padding: 12px 15px; text-align: center;">63.45</td>
              <td style="padding: 12px 15px; text-align: center;">77.06</td>
              <td style="padding: 12px 15px; text-align: center;">47.94</td>
              <td style="padding: 12px 15px; text-align: center;">62.44</td>
              <td style="padding: 12px 15px; text-align: center;">60.81</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2308.06038">DiffTPT</a> (ICCV'23)</td>
              <td style="padding: 12px 15px; text-align: center;">70.30</td>
              <td style="padding: 12px 15px; text-align: center;">55.68</td>
              <td style="padding: 12px 15px; text-align: center;">65.10</td>
              <td style="padding: 12px 15px; text-align: center;">75.00</td>
              <td style="padding: 12px 15px; text-align: center;">46.80</td>
              <td style="padding: 12px 15px; text-align: center;">62.58</td>
              <td style="padding: 12px 15px; text-align: center;">60.65</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2403.18293">TDA</a> (CVPR'24)</td>
              <td style="padding: 12px 15px; text-align: center;">69.51</td>
              <td style="padding: 12px 15px; text-align: center;">60.11</td>
              <td style="padding: 12px 15px; text-align: center;">64.67</td>
              <td style="padding: 12px 15px; text-align: center;">80.24</td>
              <td style="padding: 12px 15px; text-align: center;">50.54</td>
              <td style="padding: 12px 15px; text-align: center;">65.01</td>
              <td style="padding: 12px 15px; text-align: center;">63.89</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2403.17589">DMN</a> (CVPR'24)</td>
              <td style="padding: 12px 15px; text-align: center;">72.25</td>
              <td style="padding: 12px 15px; text-align: center;">58.28</td>
              <td style="padding: 12px 15px; text-align: center;">65.17</td>
              <td style="padding: 12px 15px; text-align: center;">78.55</td>
              <td style="padding: 12px 15px; text-align: center;">53.20</td>
              <td style="padding: 12px 15px; text-align: center;">65.49</td>
              <td style="padding: 12px 15px; text-align: center;">63.80</td>
            </tr>
            <tr style="background-color: #f5f5f5;">
              <td style="padding: 12px 15px; text-align: left;"><b>COSMIC (Ours)</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>78.19</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>73.32</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>69.62</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>85.60</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>62.79</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>73.90</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>72.83</b></td>
            </tr>
          </tbody>
        </table>
      </div>

      <p style="padding: 20px"></p>

      <!-- Second Table - Cross-Domain -->
      <div class="table-container" style="text-align: center; overflow-x: auto;">
        <table class="subtitle" style="width: 100%; margin-left: auto; margin-right: auto; min-width: 1100px; border-collapse: collapse;">
          <caption class="subtitle" style="caption-side: bottom; text-align: center; padding-top: 20px; margin-bottom: 10px;">
            <b>Top-1 accuracy (%) comparison on 10 diverse cross-domain datasets</b>
          </caption>
          <tbody>
            <tr><td colspan="12" style="border-bottom: 2px solid #ddd;"></td></tr>
            <tr>
              <th style="padding: 12px 15px; text-align: left; min-width: 220px; white-space: nowrap;">Method</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">Aircraft</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 135px;">Caltech101</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">Cars</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">DTD</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 120px;">EuroSAT</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 130px;">Flower102</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 120px;">Food101</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 100px;">Pets</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 110px;">SUN397</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 110px;">UCF101</th>
              <th style="padding: 12px 15px; text-align: center; min-width: 110px;">Average</th>
            </tr>
            <tr><td colspan="12" style="border-bottom: 2px solid #ddd;"></td></tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2103.00020">CLIP-ViT-B/16</a></td>
              <td style="padding: 12px 15px; text-align: center;">23.22</td>
              <td style="padding: 12px 15px; text-align: center;">93.55</td>
              <td style="padding: 12px 15px; text-align: center;">66.11</td>
              <td style="padding: 12px 15px; text-align: center;">45.04</td>
              <td style="padding: 12px 15px; text-align: center;">50.42</td>
              <td style="padding: 12px 15px; text-align: center;">66.99</td>
              <td style="padding: 12px 15px; text-align: center;">82.86</td>
              <td style="padding: 12px 15px; text-align: center;">86.92</td>
              <td style="padding: 12px 15px; text-align: center;">65.63</td>
              <td style="padding: 12px 15px; text-align: center;">65.16</td>
              <td style="padding: 12px 15px; text-align: center;">64.59</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2209.07511">TPT</a> (NeurIPS'22)</td>
              <td style="padding: 12px 15px; text-align: center;">24.78</td>
              <td style="padding: 12px 15px; text-align: center;">94.16</td>
              <td style="padding: 12px 15px; text-align: center;">66.87</td>
              <td style="padding: 12px 15px; text-align: center;">47.75</td>
              <td style="padding: 12px 15px; text-align: center;">42.44</td>
              <td style="padding: 12px 15px; text-align: center;">68.98</td>
              <td style="padding: 12px 15px; text-align: center;">84.67</td>
              <td style="padding: 12px 15px; text-align: center;">87.79</td>
              <td style="padding: 12px 15px; text-align: center;">65.50</td>
              <td style="padding: 12px 15px; text-align: center;">68.04</td>
              <td style="padding: 12px 15px; text-align: center;">65.10</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2308.06038">DiffTPT</a> (ICCV'23)</td>
              <td style="padding: 12px 15px; text-align: center;">25.60</td>
              <td style="padding: 12px 15px; text-align: center;">92.49</td>
              <td style="padding: 12px 15px; text-align: center;">67.01</td>
              <td style="padding: 12px 15px; text-align: center;">47.00</td>
              <td style="padding: 12px 15px; text-align: center;">43.13</td>
              <td style="padding: 12px 15px; text-align: center;">70.10</td>
              <td style="padding: 12px 15px; text-align: center;">87.23</td>
              <td style="padding: 12px 15px; text-align: center;">88.22</td>
              <td style="padding: 12px 15px; text-align: center;">65.74</td>
              <td style="padding: 12px 15px; text-align: center;">62.67</td>
              <td style="padding: 12px 15px; text-align: center;">64.92</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2403.18293">TDA</a> (CVPR'24)</td>
              <td style="padding: 12px 15px; text-align: center;">23.91</td>
              <td style="padding: 12px 15px; text-align: center;">94.24</td>
              <td style="padding: 12px 15px; text-align: center;">67.28</td>
              <td style="padding: 12px 15px; text-align: center;">47.40</td>
              <td style="padding: 12px 15px; text-align: center;">58.00</td>
              <td style="padding: 12px 15px; text-align: center;">71.42</td>
              <td style="padding: 12px 15px; text-align: center;">86.14</td>
              <td style="padding: 12px 15px; text-align: center;">88.63</td>
              <td style="padding: 12px 15px; text-align: center;">67.62</td>
              <td style="padding: 12px 15px; text-align: center;">70.66</td>
              <td style="padding: 12px 15px; text-align: center;">67.53</td>
            </tr>
            <tr>
              <td style="padding: 12px 15px; text-align: left;"><a href="https://arxiv.org/abs/2403.17589">DMN</a> (CVPR'24)</td>
              <td style="padding: 12px 15px; text-align: center;">30.03</td>
              <td style="padding: 12px 15px; text-align: center;">95.38</td>
              <td style="padding: 12px 15px; text-align: center;">67.96</td>
              <td style="padding: 12px 15px; text-align: center;">55.85</td>
              <td style="padding: 12px 15px; text-align: center;"><b>59.43</b></td>
              <td style="padding: 12px 15px; text-align: center;">74.49</td>
              <td style="padding: 12px 15px; text-align: center;">85.08</td>
              <td style="padding: 12px 15px; text-align: center;">92.04</td>
              <td style="padding: 12px 15px; text-align: center;">70.18</td>
              <td style="padding: 12px 15px; text-align: center;">72.51</td>
              <td style="padding: 12px 15px; text-align: center;">70.30</td>
            </tr>
            <tr style="background-color: #f5f5f5;">
              <td style="padding: 12px 15px; text-align: left;"><b>COSMIC (Ours)</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>31.44</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>96.80</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>71.31</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>58.23</b></td>
              <td style="padding: 12px 15px; text-align: center;">58.82</td>
              <td style="padding: 12px 15px; text-align: center;"><b>82.14</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>86.60</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>94.19</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>72.33</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>76.20</b></td>
              <td style="padding: 12px 15px; text-align: center;"><b>72.81</b></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>

<p style="padding: 15px"></p>
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{huang2024cosmic,
      title     = {COSMIC: Clique-Oriented Semantic Multi-space Integration for Robust CLIP Test-Time Adaptation},
      author    = {Huang, Fanding and Jiang, Jinyan and Jiang, Qinting and Li, Hebei and Khan, Faisal Nadeem and Wang, Zhi},
      journal   = {The IEEE/CVF Conference on Computer Vision and Pattern Recognition},
      year      = {2025}
  }</code></pre>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
      <a class="icon-link"
         href="https://arxiv.org/pdf/2403.18293.pdf">
        <i class="fas fa-file-pdf"></i>
      </a>
      <a class="icon-link" href="https://github.com/kdiAAA/TDA" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a>
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p style="text-align: center;">
            This page was built using <a
              href="https://github.com/nerfies/nerfies.github.io">this template</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
